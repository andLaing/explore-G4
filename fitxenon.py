import numpy as np
import scipy.optimize

def exp(x, l):
    return np.exp(-x/l)

x = tuple(range(1,101))
# cube
cube = (
0.97445, 0.94783, 0.92406, 0.90026, 0.87531, 0.85424, 0.83114, 0.8106, 0.78953, 0.76777, 0.74988, 0.72738, 0.71125, 0.68964, 0.67296, 0.6564, 0.63748, 0.62216, 0.60195, 0.5873, 0.57251, 0.5595, 0.54439, 0.53238, 0.51521, 0.49975, 0.48707, 0.4776, 0.46294, 0.45248, 0.44167, 0.42792, 0.4187, 0.40565, 0.39599, 0.38348, 0.37461, 0.36238, 0.35732, 0.3484, 0.33789, 0.33043, 0.32129, 0.31312, 0.30428, 0.29497, 0.28506, 0.28071, 0.27298, 0.26525, 0.25959, 0.25245, 0.24784, 0.24062, 0.23276, 0.22735, 0.22106, 0.21691, 0.2119, 0.20504, 0.1969, 0.19324, 0.188, 0.18186, 0.18125, 0.17493, 0.17055, 0.16441, 0.16226, 0.15577, 0.15391, 0.14738, 0.1455, 0.14009, 0.13579, 0.1342, 0.12979, 0.12704, 0.1232, 0.1203, 0.11728, 0.11223, 0.1113, 0.10782, 0.1044, 0.10364, 0.09976, 0.09593, 0.095, 0.09031, 0.08861, 0.08845, 0.08382, 0.08321, 0.08148, 0.08033, 0.07702, 0.07312, 0.07046, 0.07059,  )

# sphere
sphere = (
0.9673, 0.9473, 0.9199, 0.8982, 0.8703, 0.8488, 0.8304, 0.8026, 0.779, 0.7683, 0.7426, 0.728, 0.7029, 0.6897, 0.6692, 0.6514, 0.6295, 0.6203, 0.6088, 0.5827, 0.5659, 0.5567, 0.5407, 0.5192, 0.514, 0.4988, 0.4904, 0.4688, 0.4633, 0.4466, 0.4393, 0.4302, 0.4173, 0.4029, 0.3971, 0.3901, 0.3788, 0.3646, 0.3486, 0.3456, 0.3339, 0.3259, 0.3277, 0.3141, 0.3028, 0.3016, 0.2926, 0.2859, 0.2682, 0.2604, 0.2602, 0.2478, 0.2404, 0.2382, 0.2319, 0.2327, 0.2214, 0.2088, 0.2061, 0.1998, 0.1996, 0.1966, 0.1854, 0.1828, 0.1781, 0.1708, 0.1675, 0.1639, 0.1599, 0.1499, 0.1486, 0.1468, 0.141, 0.1425, 0.1376, 0.1371, 0.1247, 0.1238, 0.115, 0.1223, 0.1119, 0.1199, 0.1088, 0.105, 0.1036, 0.1036, 0.0962, 0.0989, 0.0916, 0.0917, 0.0914, 0.0888, 0.0849, 0.0788, 0.0805, 0.077, 0.0779, 0.0697, 0.0684, 0.0687,  )
# slab
slab = (0.96867, 0.94222, 0.9188, 0.89515, 0.87061, 0.84877, 0.8268, 0.80615, 0.7845, 0.76368, 0.74576, 0.72375, 0.7057, 0.68654, 0.66712, 0.6538, 0.63379, 0.61742, 0.60222, 0.5862, 0.56661, 0.55637, 0.54037, 0.52973, 0.51179, 0.50011, 0.48429, 0.47417, 0.4617, 0.45079, 0.43926, 0.42687, 0.41726, 0.40421, 0.3939, 0.38038, 0.37368, 0.36057, 0.35551, 0.34575, 0.33693, 0.3308, 0.31989, 0.31099, 0.30355, 0.29539, 0.28278, 0.27621, 0.27229, 0.26407, 0.26015, 0.25072, 0.24617, 0.24065, 0.23197, 0.22548, 0.22083, 0.21558, 0.21072, 0.20606, 0.19743, 0.19333, 0.18714, 0.18132, 0.1788, 0.17319, 0.16876, 0.16441, 0.15987, 0.15544, 0.15169, 0.14813, 0.14357, 0.14053, 0.13509, 0.13263, 0.12887, 0.12607, 0.1222, 0.12034, 0.11699, 0.11206, 0.1099, 0.10799, 0.1054, 0.10137, 0.1004, 0.09567, 0.0936, 0.09165, 0.08815, 0.08656, 0.08474, 0.08228, 0.08027, 0.07825, 0.07646, 0.07428, 0.07208, 0.06969,  )

x = np.array(x) / 10


def fit(data):
    return scipy.optimize.curve_fit(exp, x, np.array(data), (3.7,))

def plot_decay(attlength, style):
    plt.plot(xs, exp(xs, attlength), style, label=f'exp(-x/{attlength:4.2f}cm)')

(l_cube,)  , (cov_cube,)   = fit(cube)
(l_slab,)  , (cov_slab,)   = fit(slab)
(l_sphere,), (cov_sphere,) = fit(sphere)

import matplotlib.pyplot as plt
xs = np.linspace(0, x[-1])

plt.plot(x, cube  , 'sy', label='centre of cube')
plt.plot(x, slab  , '_b', label='side of slab')
plt.plot(x, sphere, '.r', label='centre of sphere')
plot_decay(l_sphere, 'r')
plot_decay(3.7     , 'g')
plt.xlim(0, x[-1])
plt.ylim(0, None)
plt.legend()
plt.show()
